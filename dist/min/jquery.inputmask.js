/*
 Input Mask plugin for jquery
 http://github.com/RobinHerbots/jquery.inputmask
 Copyright (c) 2010 - 2013 Robin Herbots
 Licensed under the MIT license (http://www.opensource.org/licenses/mit-license.php)
 Version: 1.3.8
*/
(function(f){void 0==f.fn.inputmask&&(f.inputmask={defaults:{placeholder:"_",optionalmarker:{start:"[",end:"]"},escapeChar:"\\",mask:null,oncomplete:f.noop,onincomplete:f.noop,oncleared:f.noop,repeat:0,greedy:!0,autoUnmask:!1,clearMaskOnLostFocus:!0,insertMode:!0,clearIncomplete:!1,aliases:{},onKeyUp:f.noop,onKeyDown:f.noop,showMaskOnFocus:!0,showMaskOnHover:!0,onKeyValidation:f.noop,numericInput:!1,radixPoint:"",definitions:{9:{validator:"[0-9]",cardinality:1},a:{validator:"[A-Za-z\u0410-\u044f\u0401\u0451]",
cardinality:1},"*":{validator:"[A-Za-z\u0410-\u044f\u0401\u04510-9]",cardinality:1}},keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91},ignorables:[9,13,19,27,33,34,35,36,37,
38,39,40,45,46,93,112,113,114,115,116,117,118,119,120,121,122,123],getMaskLength:function(f,A,r){var C=f.length;!A&&1<r&&(C+=f.length*(r-1));return C}},val:f.fn.val,escapeRegex:function(f){return f.replace(RegExp("(\\/|\\.|\\*|\\+|\\?|\\||\\(|\\)|\\[|\\]|\\{|\\}|\\\\)","gim"),"\\$1")}},f.fn.inputmask=function(s,A){function r(e,c){var b=a.aliases[e];return b?(b.alias&&r(b.alias),f.extend(!0,a,b),f.extend(!0,a,c),!0):!1}function C(){var e=!1,c=0,b=a.mask.toString();1==b.length&&!1==a.greedy&&(a.placeholder=
"");for(var b=f.map(b.split(""),function(b){var f=[];if(b==a.escapeChar)e=true;else if(b!=a.optionalmarker.start&&b!=a.optionalmarker.end||e){var E=a.definitions[b];if(E&&!e)for(b=0;b<E.cardinality;b++)f.push(w(c+b));else{f.push(b);e=false}c=c+f.length;return f}}),E=b.slice(),g=1;g<a.repeat&&a.greedy;g++)E=E.concat(b.slice());return E}function I(){var e=!1,c=!1,b=!1;return f.map(a.mask.toString().split(""),function(f){var g=[];if(f==a.escapeChar)c=!0;else if(f==a.optionalmarker.start&&!c)b=e=!0;else if(f==
a.optionalmarker.end&&!c)e=!1,b=!0;else{var h=a.definitions[f];if(h&&!c){for(var j=h.prevalidator,k=j?j.length:0,m=1;m<h.cardinality;m++){var l=k>=m?j[m-1]:[],d=l.validator,l=l.cardinality;g.push({fn:d?"string"==typeof d?RegExp(d):new function(){this.test=d}:/./,cardinality:l?l:1,optionality:e,newBlockMarker:!0==e?b:!1,offset:0,casing:h.casing,def:f});!0==e&&(b=!1)}g.push({fn:h.validator?"string"==typeof h.validator?RegExp(h.validator):new function(){this.test=h.validator}:/./,cardinality:h.cardinality,
optionality:e,newBlockMarker:b,offset:0,casing:h.casing,def:f})}else g.push({fn:null,cardinality:0,optionality:e,newBlockMarker:b,offset:0,casing:null,def:f}),c=!1;b=!1;return g}})}function H(e,c,b,f){var g=!1;if(0<=e&&e<o(b)){for(var j=e%h.length,t=c?1:0,k="",m=h[j].cardinality;m>t;m--)k+=v(b,j-(m-1));c&&(k+=c);g=null!=h[j].fn?h[j].fn.test(k,b,e,f,a):!1}setTimeout(function(){a.onKeyValidation.call(this,g,a)},0);return g}function t(e){e=h[e%h.length];return void 0!=e?e.fn:!1}function w(e){return a.placeholder.charAt(e%
a.placeholder.length)}function o(e){return a.getMaskLength(g,a.greedy,a.repeat,e,a)}function x(e,a){var b=o(e);if(a>=b)return b;for(var f=a;++f<b&&!t(f););return f}function M(e,a){var b=a;if(0>=b)return 0;for(;0<--b&&!t(b););return b}function F(e,a,b){var f=h[a%h.length],g=b;if(void 0!=g)switch(f.casing){case "upper":g=b.toUpperCase();break;case "lower":g=b.toLowerCase()}e[a]=g}function v(e,a,b){b&&(a=P(e,a));return e[a]}function P(a,c,b){if(b)for(;0>c&&a.length<o(a);){b=g.length-1;for(c=g.length;void 0!==
g[b];)a.unshift(g[b--])}else for(;void 0==a[c]&&a.length<o(a);)for(b=0;void 0!==g[b];)a.push(g[b++]);return c}function y(a,c,b){a._valueSet(c.join(""));void 0!=b&&(J?setTimeout(function(){j(a,b)},100):j(a,b))}function Q(a,c,b){for(var f=o(a);c<b&&c<f;c++)F(a,c,v(g.slice(),c))}function K(a,c){F(a,c,v(g,c%h.length))}function n(e,c,b,E){var j=f(e).data("inputmask").isRTL,B=N(e._valueGet(),j).split(""),n=o(c);if(j){var k=B.reverse();k.length=n;for(var m=0;m<n;m++){var l=(n-(m+1))%h.length;null==h[l].fn&&
k[m]!=v(g,l)?(k.splice(m,0,v(g,l)),k.length=n):k[m]=k[m]||v(g,l)}B=k.reverse()}Q(c,0,c.length);c.length=g.length;for(var d=k=-1,u,s=B.length,l=0==s?n:-1,m=0;m<s;m++)for(var p=d+1;p<n;p++)if(t(p)){var r=B[m];!1!==(u=H(p,r,c,!b))?(!0!==u&&(p=void 0!=u.pos?u.pos:p,r=void 0!=u.c?u.c:r),F(c,p,r),k=d=p):(K(c,p),r==w(p)&&(l=d=p));break}else if(K(c,p),k==d&&(k=p),d=p,B[m]==v(c,p))break;if(!1==a.greedy)for(m=N(c.join(""),j).split("");c.length!=m.length;)j?c.shift():c.pop();b&&y(e,c);return j?a.numericInput?
""!=a.radixPoint&&-1!=f.inArray(a.radixPoint,c)&&!0!==E?f.inArray(a.radixPoint,c):x(c,n):x(c,l):x(c,k)}function R(a){return f.inputmask.escapeRegex.call(this,a)}function N(a,c){return c?a.replace(RegExp("^("+R(g.join(""))+")*"),""):a.replace(RegExp("("+R(g.join(""))+")*$"),"")}function S(a,c){n(a,c,!1);var b=c.slice();if(f(a).data("inputmask").isRTL)for(var g=0;g<=b.length-1;g++){var j=g%h.length;if(h[j].optionality)if(w(g)==c[g]||!t(g))b.splice(0,1);else break;else break}else for(g=b.length-1;0<=
g;g--)if(j=g%h.length,h[j].optionality)if(w(g)==c[g]||!t(g))b.pop();else break;else break;y(a,b)}function T(a,c){var b=a[0];if(h&&(!0===c||!a.hasClass("hasDatepicker"))){var j=g.slice();n(b,j);return f.map(j,function(a,c){return t(c)&&a!=v(g.slice(),c)?a:null}).join("")}return b._valueGet()}function j(e,c,b){if(f(e).is(":visible"))if(e=e.jquery&&0<e.length?e[0]:e,"number"==typeof c){b="number"==typeof b?b:c;!1==a.insertMode&&c==b&&b++;if(e.setSelectionRange)e.setSelectionRange(c,b);else if(e.createTextRange){var g=
e.createTextRange();g.collapse(!0);g.moveEnd("character",b);g.moveStart("character",c);g.select()}e.focus()}else{var j=J?g:null,g=null;null==j&&(e.setSelectionRange?(c=e.selectionStart,b=e.selectionEnd):document.selection&&document.selection.createRange&&(g=document.selection.createRange(),c=0-g.duplicate().moveStart("character",-1E5),b=c+g.text.length),j={begin:c,end:b});return j}}function O(a){for(var c=!0,a=a._valueGet(),b=a.length,f=0;f<b;f++)if(t(f)&&a.charAt(f)==w(f)){c=!1;break}return c}function L(e){function c(a){a=
f._data(a).events;f.each(a,function(a,d){f.each(d,function(a,d){if("inputmask"==d.namespace){var c=d.handler;d.handler=function(){return this.readOnly||this.disabled?!1:c.apply(this,arguments)}}})})}function b(a){var d;Object.getOwnPropertyDescriptor&&(d=Object.getOwnPropertyDescriptor(a,"value"));if(d&&d.get)a._valueGet||(a._valueGet=d.get,a._valueSet=d.set,Object.defineProperty(a,"value",{get:function(){var a=f(this),d=f(this).data("inputmask");return d&&d.autoUnmask?a.inputmask("unmaskedvalue"):
this._valueGet()!=d._buffer.join("")?this._valueGet():""},set:function(a){this._valueSet(a);f(this).triggerHandler("setvalue.inputmask")}}));else if(document.__lookupGetter__&&a.__lookupGetter__("value"))a._valueGet||(a._valueGet=a.__lookupGetter__("value"),a._valueSet=a.__lookupSetter__("value"),a.__defineGetter__("value",function(){var a=f(this),d=f(this).data("inputmask");return d&&d.autoUnmask?a.inputmask("unmaskedvalue"):this._valueGet()!=d._buffer.join("")?this._valueGet():""}),a.__defineSetter__("value",
function(a){this._valueSet(a);f(this).triggerHandler("setvalue.inputmask")}));else if(a._valueGet||(a._valueGet=function(){return this.value},a._valueSet=function(a){this.value=a}),!0!=f.fn.val.inputmaskpatch)f.fn.val=function(){if(arguments.length==0){var a=f(this);if(a.data("inputmask")){if(a.data("inputmask").autoUnmask)return a.inputmask("unmaskedvalue");var d=f.inputmask.val.apply(a);return d!=a.data("inputmask")._buffer.join("")?d:""}return f.inputmask.val.apply(a)}var c=arguments;return this.each(function(){var a=
f(this),d=f.inputmask.val.apply(a,c);a.data("inputmask")&&a.triggerHandler("setvalue.inputmask");return d})},f.extend(f.fn.val,{inputmaskpatch:!0})}function r(d,c){if(a.numericInput&&""!=a.radixPoint){var b=d._valueGet().indexOf(a.radixPoint);z=c.begin<=b||c.end<=b||-1==b}}function s(a,c,b){for(;!t(a)&&0<=a-1;)a--;for(var f=a;f<c&&f<o(d);f++)if(t(f)){K(d,f);var e=x(d,f),i=v(d,e);if(i!=w(e))if(e<o(d)&&!1!==H(f,i,d,!0)&&h[f%h.length].def==h[e%h.length].def)F(d,f,v(d,e)),K(d,e);else{if(t(f))break}else if(void 0==
b)break}else K(d,f);void 0!=b&&F(d,z?c:M(d,c),b);d=N(d.join(""),z).split("");0==d.length&&(d=g.slice());return a}function B(a,c,b,f){for(;a<=c&&a<o(d);a++)if(t(a)){var e=v(d,a);F(d,a,b);if(e!=w(a))if(b=x(d,a),b<o(d))if(!1!==H(b,e,d,!0)&&h[a%h.length].def==h[b%h.length].def)b=e;else if(t(b))break;else b=e;else break;else if(!0!==f)break}else K(d,a);f=d.length;d=N(d.join(""),z).split("");0==d.length&&(d=g.slice());return c-(f-d.length)}function C(c){p=!1;var b=this,e=c.keyCode,h=j(b);r(b,h);if(e==a.keyCode.BACKSPACE||
e==a.keyCode.DELETE||U&&127==e){var q=o(d);if(0==h.begin&&h.end==q)d=g.slice(),y(b,d),j(b,n(b,d,!1));else if(1<h.end-h.begin||1==h.end-h.begin&&a.insertMode)Q(d,h.begin,h.end),y(b,d),j(z?n(b,d,!1):h.begin);else{var i=h.begin;e==a.keyCode.DELETE?(i<D&&(i=D),i<q&&(a.numericInput&&""!=a.radixPoint&&d[i]==a.radixPoint?(i=d.length-1==i?i:x(d,i),i=s(i,q)):z?(i=B(D,i,w(i),!0),i=x(d,i)):i=s(i,q),y(b,d,i))):e==a.keyCode.BACKSPACE&&i>D&&(i-=1,a.numericInput&&""!=a.radixPoint&&d[i]==a.radixPoint?(i=B(D,d.length-
1==i?i:i-1,w(i),!0),i++):z?(i=B(D,i,w(i),!0),i=d[i+1]==a.radixPoint?i+1:x(d,i)):i=s(i,q),y(b,d,i))}b._valueGet()==g.join("")&&f(b).trigger("cleared");c.preventDefault()}else e==a.keyCode.END||e==a.keyCode.PAGE_DOWN?setTimeout(function(){var e=n(b,d,!1,!0);!a.insertMode&&(e==o(d)&&!c.shiftKey)&&e--;j(b,c.shiftKey?h.begin:e,e)},0):e==a.keyCode.HOME||e==a.keyCode.PAGE_UP?j(b,0,c.shiftKey?h.begin:0):e==a.keyCode.ESCAPE?(b._valueSet(A),j(b,0,n(b,d))):e==a.keyCode.INSERT?(a.insertMode=!a.insertMode,j(b,
!a.insertMode&&h.begin==o(d)?h.begin-1:h.begin)):c.ctrlKey&&88==e?setTimeout(function(){j(b,n(b,d,!0))},0):a.insertMode||(e==a.keyCode.RIGHT?(q=h.begin==h.end?h.end+1:h.end,q=q<o(d)?q:h.end,j(b,c.shiftKey?h.begin:q,c.shiftKey?q+1:q)):e==a.keyCode.LEFT&&(q=h.begin-1,q=0<q?q:0,j(b,q,c.shiftKey?h.end:q)));a.onKeyDown.call(this,c,d,a);I=-1!=f.inArray(e,a.ignorables)}function k(b){if(p)return!1;p=!0;var c=this,e=f(c),b=b||window.event,g=b.which||b.charCode||b.keyCode,h=String.fromCharCode(g);if(a.numericInput&&
h==a.radixPoint){var i=c._valueGet().indexOf(a.radixPoint);j(c,x(d,-1!=i?i:o(d)))}if(b.ctrlKey||b.altKey||b.metaKey||I)return!0;if(g){e.trigger("input");var l=j(c),m=o(d),g=!0;Q(d,l.begin,l.end);if(z){var i=M(d,l.end),k;if(!1!==(k=H(i==m||v(d,i)==a.radixPoint?M(d,i):i,h,d,!1))){!0!==k&&(i=void 0!=k.pos?k.pos:i,h=void 0!=k.c?k.c:h);m=o(d);k=D;if(!0==a.insertMode){if(!0==a.greedy)for(var n=d.slice();v(n,k,!0)!=w(k)&&k<=i;)k=k==m?m+1:x(d,k);k<=i&&(a.greedy||d.length<m)?(d[D]!=w(D)&&d.length<m&&(n=P(d,
-1,z),0!=l.end&&(i+=n),m=d.length),s(k,i,h)):g=!1}else F(d,i,h);g&&(y(c,d,a.numericInput?i+1:i),setTimeout(function(){O(c)&&e.trigger("complete")},0))}else J&&y(c,d,l.begin)}else if(i=x(d,l.begin-1),P(d,i,z),!1!==(k=H(i,h,d,!1))){!0!==k&&(i=void 0!=k.pos?k.pos:i,h=void 0!=k.c?k.c:h);if(!0==a.insertMode){l=o(d);for(n=d.slice();v(n,l,!0)!=w(l)&&l>=i;)l=0==l?-1:M(d,l);l>=i?B(i,d.length,h):g=!1}else F(d,i,h);g&&(h=x(d,i),y(c,d,h),setTimeout(function(){O(c)&&e.trigger("complete")},0))}else J&&y(c,d,l.begin);
b.preventDefault()}}function m(b){var c=f(this),e=b.keyCode;a.onKeyUp.call(this,b,d,a);e==a.keyCode.TAB&&(c.hasClass("focus.inputmask")&&0==this._valueGet().length&&a.showMaskOnFocus)&&(d=g.slice(),y(this,d),z||j(this,0),A=this._valueGet())}var l=f(e);if(l.is(":input")){var d=g.slice();a.greedy=a.greedy?a.greedy:0==a.repeat;var u=l.prop("maxLength");o(d)>u&&-1<u&&(u<g.length&&(g.length=u),!1==a.greedy&&(a.repeat=Math.round(u/g.length)),l.prop("maxLength",2*o(d)));l.data("inputmask",{tests:h,_buffer:g,
greedy:a.greedy,repeat:a.repeat,autoUnmask:a.autoUnmask,definitions:a.definitions,isRTL:!1});b(e);var A=e._valueGet(),p=!1,I=!1,G=-1,D=x(d,-1);M(d,o(d));var z=!1;if("rtl"==e.dir||a.numericInput)e.dir="ltr",l.css("text-align","right"),l.removeAttr("dir"),u=l.data("inputmask"),u.isRTL=!0,l.data("inputmask",u),z=!0;l.unbind(".inputmask");l.removeClass("focus.inputmask");l.bind("mouseenter.inputmask",function(){if(!f(this).hasClass("focus.inputmask")&&a.showMaskOnHover){var b=this._valueGet().length;
b<d.length&&(0==b&&(d=g.slice()),y(this,d))}}).bind("blur.inputmask",function(){var b=f(this),c=this._valueGet();b.removeClass("focus.inputmask");c!=A&&b.change();a.clearMaskOnLostFocus&&""!=c&&(c==g.join("")?this._valueSet(""):S(this,d));O(this)||(b.trigger("incomplete"),a.clearIncomplete&&(a.clearMaskOnLostFocus?this._valueSet(""):(d=g.slice(),y(this,d))))}).bind("focus.inputmask",function(){var b=f(this),c=this._valueGet();if(a.showMaskOnFocus&&!b.hasClass("focus.inputmask")&&(!a.showMaskOnHover||
a.showMaskOnHover&&""==c))c=c.length,c<d.length&&(0==c&&(d=g.slice()),j(this,n(this,d,!0)));b.addClass("focus.inputmask");A=this._valueGet()}).bind("mouseleave.inputmask",function(){var b=f(this);a.clearMaskOnLostFocus&&(b.hasClass("focus.inputmask")||(this._valueGet()==g.join("")||""==this._valueGet()?this._valueSet(""):S(this,d)))}).bind("click.inputmask",function(){var a=this;setTimeout(function(){var b=j(a);if(b.begin==b.end){var c=b.begin;G=n(a,d,!1);r(a,b);z?j(a,c>G&&(!1!==H(c,d[c],d,!0)||!t(c))?
c:G):j(a,c<G&&(!1!==H(c,d[c],d,!0)||!t(c))?c:G)}},0)}).bind("dblclick.inputmask",function(){var a=this;setTimeout(function(){j(a,0,G)},0)}).bind("keydown.inputmask",C).bind("keypress.inputmask",k).bind("keyup.inputmask",m).bind(V+".inputmask dragdrop.inputmask drop.inputmask",function(){var a=this;setTimeout(function(){j(a,n(a,d,!0))},0)}).bind("setvalue.inputmask",function(){A=this._valueGet();n(this,d,!0);this._valueGet()==g.join("")&&this._valueSet("")}).bind("complete.inputmask",a.oncomplete).bind("incomplete.inputmask",
a.onincomplete).bind("cleared.inputmask",a.oncleared);var G=n(e,d,!0),L;try{L=document.activeElement}catch(R){}L===e?(l.addClass("focus.inputmask"),j(e,G)):a.clearMaskOnLostFocus&&(e._valueGet()==g.join("")?e._valueSet(""):S(e,d));c(e)}}var a=f.extend(!0,{},f.inputmask.defaults,A),V=function(a){var c=document.createElement("input"),a="on"+a,b=a in c;b||(c.setAttribute(a,"return;"),b="function"==typeof c[a]);return b}("paste")?"paste":"input",U=null!=navigator.userAgent.match(/iphone/i),J=null!=navigator.userAgent.match(/android.*mobile safari.*/i);
if(J)var W=navigator.userAgent.match(/mobile safari.*/i),J=533>=parseInt(RegExp(/[0-9]+/).exec(W));if("string"==typeof s)switch(s){case "mask":r(a.alias,A);var g=C(),h=I();return this.each(function(){L(this)});case "unmaskedvalue":return h=this.data("inputmask").tests,g=this.data("inputmask")._buffer,a.greedy=this.data("inputmask").greedy,a.repeat=this.data("inputmask").repeat,a.definitions=this.data("inputmask").definitions,T(this);case "remove":return this.each(function(){var e=f(this),c=this;setTimeout(function(){if(e.data("inputmask")){h=
e.data("inputmask").tests;g=e.data("inputmask")._buffer;a.greedy=e.data("inputmask").greedy;a.repeat=e.data("inputmask").repeat;a.definitions=e.data("inputmask").definitions;c._valueSet(T(e,!0));e.removeData("inputmask");e.unbind(".inputmask");e.removeClass("focus.inputmask");var b;Object.getOwnPropertyDescriptor&&(b=Object.getOwnPropertyDescriptor(c,"value"));b&&b.get?c._valueGet&&Object.defineProperty(c,"value",{get:c._valueGet,set:c._valueSet}):document.__lookupGetter__&&c.__lookupGetter__("value")&&
c._valueGet&&(c.__defineGetter__("value",c._valueGet),c.__defineSetter__("value",c._valueSet));delete c._valueGet;delete c._valueSet}},0)});case "getemptymask":return this.data("inputmask")?this.data("inputmask")._buffer.join(""):"";case "hasMaskedValue":return this.data("inputmask")?!this.data("inputmask").autoUnmask:!1;case "isComplete":return h=this.data("inputmask").tests,g=this.data("inputmask")._buffer,a.greedy=this.data("inputmask").greedy,a.repeat=this.data("inputmask").repeat,a.definitions=
this.data("inputmask").definitions,O(this[0]);default:return r(s,A)||(a.mask=s),g=C(),h=I(),this.each(function(){L(this)})}else{if("object"==typeof s)return a=f.extend(!0,{},f.inputmask.defaults,s),r(a.alias,s),g=C(),h=I(),this.each(function(){L(this)});if(void 0==s)return this.each(function(){var e=f(this).attr("data-inputmask");if(e&&""!=e)try{var e=e.replace(RegExp("'","g"),'"'),c=f.parseJSON("{"+e+"}");a=f.extend(!0,{},f.inputmask.defaults,c);r(a.alias,c);a.alias=void 0;f(this).inputmask(a)}catch(b){}})}return this})})(jQuery);
