/*
 Input Mask plugin for jquery
 http://github.com/RobinHerbots/jquery.inputmask
 Copyright (c) 2010 - 2013 Robin Herbots
 Licensed under the MIT license (http://www.opensource.org/licenses/mit-license.php)
 Version: 1.3.14
*/
(function(f){void 0==f.fn.inputmask&&(f.inputmask={defaults:{placeholder:"_",optionalmarker:{start:"[",end:"]"},escapeChar:"\\",mask:null,oncomplete:f.noop,onincomplete:f.noop,oncleared:f.noop,repeat:0,greedy:!0,autoUnmask:!1,clearMaskOnLostFocus:!0,insertMode:!0,clearIncomplete:!1,aliases:{},onKeyUp:f.noop,onKeyDown:f.noop,showMaskOnFocus:!0,showMaskOnHover:!0,onKeyValidation:f.noop,numericInput:!1,radixPoint:"",definitions:{9:{validator:"[0-9]",cardinality:1},a:{validator:"[A-Za-z\u0410-\u044f\u0401\u0451]",
cardinality:1},"*":{validator:"[A-Za-z\u0410-\u044f\u0401\u04510-9]",cardinality:1}},keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91},ignorables:[9,13,19,27,33,34,35,36,37,
38,39,40,45,46,93,112,113,114,115,116,117,118,119,120,121,122,123],getMaskLength:function(f,A,s){var D=f.length;!A&&1<s&&(D+=f.length*(s-1));return D}},val:f.fn.val,escapeRegex:function(f){return f.replace(RegExp("(\\/|\\.|\\*|\\+|\\?|\\||\\(|\\)|\\[|\\]|\\{|\\}|\\\\)","gim"),"\\$1")}},f.fn.inputmask=function(t,A){function s(e,b){var c=a.aliases[e];return c?(c.alias&&s(c.alias),f.extend(!0,a,c),f.extend(!0,a,b),!0):!1}function D(){var e=!1,b=0,c=a.mask.toString();1==c.length&&!1==a.greedy&&(a.placeholder=
"");for(var c=f.map(c.split(""),function(c){var f=[];if(c==a.escapeChar)e=true;else if(c!=a.optionalmarker.start&&c!=a.optionalmarker.end||e){var j=a.definitions[c];if(j&&!e)for(c=0;c<j.cardinality;c++)f.push(B(b+c));else{f.push(c);e=false}b=b+f.length;return f}}),E=c.slice(),j=1;j<a.repeat&&a.greedy;j++)E=E.concat(c.slice());return E}function J(){var e=!1,b=!1,c=!1;return f.map(a.mask.toString().split(""),function(f){var j=[];if(f==a.escapeChar)b=!0;else if(f==a.optionalmarker.start&&!b)c=e=!0;else if(f==
a.optionalmarker.end&&!b)e=!1,c=!0;else{var g=a.definitions[f];if(g&&!b){for(var h=g.prevalidator,k=h?h.length:0,m=1;m<g.cardinality;m++){var l=k>=m?h[m-1]:[],d=l.validator,l=l.cardinality;j.push({fn:d?"string"==typeof d?RegExp(d):new function(){this.test=d}:/./,cardinality:l?l:1,optionality:e,newBlockMarker:!0==e?c:!1,offset:0,casing:g.casing,def:f});!0==e&&(c=!1)}j.push({fn:g.validator?"string"==typeof g.validator?RegExp(g.validator):new function(){this.test=g.validator}:/./,cardinality:g.cardinality,
optionality:e,newBlockMarker:c,offset:0,casing:g.casing,def:f})}else j.push({fn:null,cardinality:0,optionality:e,newBlockMarker:c,offset:0,casing:null,def:f}),b=!1;c=!1;return j}})}function C(e,b,c,f){var j=!1;if(0<=e&&e<p(c)){for(var g=e%h.length,n=b?1:0,k="",m=h[g].cardinality;m>n;m--)k+=w(c,g-(m-1));b&&(k+=b);j=null!=h[g].fn?h[g].fn.test(k,c,e,f,a):!1}setTimeout(function(){a.onKeyValidation.call(this,j,a)},0);return j}function v(e){e=h[e%h.length];return void 0!=e?e.fn:!1}function B(e){return a.placeholder.charAt(e%
a.placeholder.length)}function p(e){return a.getMaskLength(g,a.greedy,a.repeat,e,a)}function x(e,a){var c=p(e);if(a>=c)return c;for(var f=a;++f<c&&!v(f););return f}function M(e,a){var c=a;if(0>=c)return 0;for(;0<--c&&!v(c););return c}function G(a,b,c){var f=h[b%h.length],j=c;if(void 0!=j)switch(f.casing){case "upper":j=c.toUpperCase();break;case "lower":j=c.toLowerCase()}a[b]=j}function w(a,b,c){c&&(b=Q(a,b));return a[b]}function Q(a,b,c){if(c)for(;0>b&&a.length<p(a);){c=g.length-1;for(b=g.length;void 0!==
g[c];)a.unshift(g[c--])}else for(;void 0==a[b]&&a.length<p(a);)for(c=0;void 0!==g[c];)a.push(g[c++]);return b}function y(a,b,c){a._valueSet(b.join(""));void 0!=c&&(K?setTimeout(function(){n(a,c)},100):n(a,c))}function R(a,b,c){for(var f=p(a);b<c&&b<f;b++)G(a,b,w(g.slice(),b))}function L(a,b){G(a,b,w(g,b%h.length))}function o(e,b,c,E){var j=f(e).data("inputmask").isRTL,n=N(e._valueGet(),j).split(""),o=p(b);if(j){var k=n.reverse();k.length=o;for(var m=0;m<o;m++){var l=(o-(m+1))%h.length;null==h[l].fn&&
k[m]!=w(g,l)?(k.splice(m,0,w(g,l)),k.length=o):k[m]=k[m]||w(g,l)}n=k.reverse()}R(b,0,b.length);b.length=g.length;for(var d=k=-1,u,t=n.length,l=0==t?o:-1,m=0;m<t;m++)for(var q=d+1;q<o;q++)if(v(q)){var s=n[m];!1!==(u=C(q,s,b,!c))?(!0!==u&&(q=void 0!=u.pos?u.pos:q,s=void 0!=u.c?u.c:s),G(b,q,s),k=d=q):(L(b,q),s==B(q)&&(l=d=q));break}else if(L(b,q),k==d&&(k=q),d=q,n[m]==w(b,q))break;if(!1==a.greedy)for(m=N(b.join(""),j).split("");b.length!=m.length;)j?b.shift():b.pop();c&&y(e,b);return j?a.numericInput?
""!=a.radixPoint&&-1!=f.inArray(a.radixPoint,b)&&!0!==E?f.inArray(a.radixPoint,b):x(b,o):x(b,l):x(b,k)}function T(a){return f.inputmask.escapeRegex.call(this,a)}function N(a,b){return b?a.replace(RegExp("^("+T(g.join(""))+")*"),""):a.replace(RegExp("("+T(g.join(""))+")*$"),"")}function S(a,b){o(a,b,!1);var c=b.slice(),g,j;if(f(a).data("inputmask").isRTL)for(j=0;j<=c.length-1;j++)if(g=j%h.length,h[g].optionality)if(!v(j)||!C(j,b[j],b,!0))c.splice(0,1);else break;else break;else for(j=c.length-1;0<=
j;j--)if(g=j%h.length,h[g].optionality)if(!v(j)||!C(j,b[j],b,!0))c.pop();else break;else break;y(a,c)}function U(a,b){var c=a[0];if(h&&(!0===b||!a.hasClass("hasDatepicker"))){var E=g.slice();o(c,E);return f.map(E,function(a,b){return v(b)&&C(b,a,E,!0)?a:null}).join("")}return c._valueGet()}function n(e,b,c){var g=e.jquery&&0<e.length?e[0]:e;if("number"==typeof b){if(f(e).is(":visible")){c="number"==typeof c?c:b;!1==a.insertMode&&b==c&&c++;if(g.setSelectionRange)c==b?(g.focus(),g.setSelectionRange(b,
c)):(g.select(),g.selectionStart=b,g.selectionEnd=V?b:c);else if(g.createTextRange){var j=g.createTextRange();j.collapse(!0);j.moveEnd("character",c);j.moveStart("character",b);j.select()}g.focus()}}else{if(!f(e).is(":visible"))return{begin:0,end:0};e=K?j:null;j=null;null==e&&(g.setSelectionRange?(b=g.selectionStart,c=g.selectionEnd):document.selection&&document.selection.createRange&&(j=document.selection.createRange(),b=0-j.duplicate().moveStart("character",-1E5),c=b+j.text.length),e={begin:b,end:c});
return e}}function O(a){for(var b=!0,a=a._valueGet(),c=a.length,f=0;f<c;f++)if(v(f)&&a.charAt(f)==B(f)){b=!1;break}return b}function P(e){function b(a){a=f._data(a).events;f.each(a,function(a,d){f.each(d,function(a,d){if("inputmask"==d.namespace){var b=d.handler;d.handler=function(){return this.readOnly||this.disabled?!1:b.apply(this,arguments)}}})})}function c(a){var d;Object.getOwnPropertyDescriptor&&(d=Object.getOwnPropertyDescriptor(a,"value"));if(d&&d.get)a._valueGet||(a._valueGet=d.get,a._valueSet=
d.set,Object.defineProperty(a,"value",{get:function(){var a=f(this),d=f(this).data("inputmask");return d&&d.autoUnmask?a.inputmask("unmaskedvalue"):this._valueGet()!=d._buffer.join("")?this._valueGet():""},set:function(a){this._valueSet(a);f(this).triggerHandler("setvalue.inputmask")}}));else if(document.__lookupGetter__&&a.__lookupGetter__("value"))a._valueGet||(a._valueGet=a.__lookupGetter__("value"),a._valueSet=a.__lookupSetter__("value"),a.__defineGetter__("value",function(){var a=f(this),d=f(this).data("inputmask");
return d&&d.autoUnmask?a.inputmask("unmaskedvalue"):this._valueGet()!=d._buffer.join("")?this._valueGet():""}),a.__defineSetter__("value",function(a){this._valueSet(a);f(this).triggerHandler("setvalue.inputmask")}));else if(a._valueGet||(a._valueGet=function(){return this.value},a._valueSet=function(a){this.value=a}),!0!=f.fn.val.inputmaskpatch)f.fn.val=function(){if(arguments.length==0){var a=f(this);if(a.data("inputmask")){if(a.data("inputmask").autoUnmask)return a.inputmask("unmaskedvalue");var d=
f.inputmask.val.apply(a);return d!=a.data("inputmask")._buffer.join("")?d:""}return f.inputmask.val.apply(a)}var b=arguments;return this.each(function(){var a=f(this),d=f.inputmask.val.apply(a,b);a.data("inputmask")&&a.triggerHandler("setvalue.inputmask");return d})},f.extend(f.fn.val,{inputmaskpatch:!0})}function s(d,b){if(a.numericInput&&""!=a.radixPoint){var c=d._valueGet().indexOf(a.radixPoint);z=b.begin<=c||b.end<=c||-1==c}}function j(a,b,c){for(;!v(a)&&0<=a-1;)a--;for(var f=a;f<b&&f<p(d);f++)if(v(f)){L(d,
f);var e=x(d,f),i=w(d,e);if(i!=B(e))if(e<p(d)&&!1!==C(f,i,d,!0)&&h[f%h.length].def==h[e%h.length].def)G(d,f,w(d,e)),L(d,e);else{if(v(f))break}else if(void 0==c)break}else L(d,f);void 0!=c&&G(d,z?b:M(d,b),c);d=N(d.join(""),z).split("");0==d.length&&(d=g.slice());return a}function t(a,b,c,f){for(;a<=b&&a<p(d);a++)if(v(a)){var e=w(d,a);G(d,a,c);if(e!=B(a))if(c=x(d,a),c<p(d))if(!1!==C(c,e,d,!0)&&h[a%h.length].def==h[c%h.length].def)c=e;else if(v(c))break;else c=e;else break;else if(!0!==f)break}else L(d,
a);f=d.length;d=N(d.join(""),z).split("");0==d.length&&(d=g.slice());return b-(f-d.length)}function D(b){q=!1;var c=this,e=b.keyCode,h=n(c);s(c,h);if(e==a.keyCode.BACKSPACE||e==a.keyCode.DELETE||W&&127==e){var r=p(d);if(0==h.begin&&h.end==r)d=g.slice(),y(c,d),n(c,o(c,d,!1));else if(1<h.end-h.begin||1==h.end-h.begin&&a.insertMode)R(d,h.begin,h.end),y(c,d,z?o(c,d,!1):h.begin);else{var i=h.begin;e==a.keyCode.DELETE?(i<F&&(i=F),i<r&&(a.numericInput&&""!=a.radixPoint&&d[i]==a.radixPoint?(i=d.length-1==
i?i:x(d,i),i=j(i,r)):z?(i=t(F,i,B(i),!0),i=x(d,i)):i=j(i,r),y(c,d,i))):e==a.keyCode.BACKSPACE&&i>F&&(i-=1,a.numericInput&&""!=a.radixPoint&&d[i]==a.radixPoint?(i=t(F,d.length-1==i?i:i-1,B(i),!0),i++):z?(i=t(F,i,B(i),!0),i=d[i+1]==a.radixPoint?i+1:x(d,i)):i=j(i,r),y(c,d,i))}c._valueGet()==g.join("")&&f(c).trigger("cleared");b.preventDefault()}else e==a.keyCode.END||e==a.keyCode.PAGE_DOWN?setTimeout(function(){var e=o(c,d,!1,!0);!a.insertMode&&(e==p(d)&&!b.shiftKey)&&e--;n(c,b.shiftKey?h.begin:e,e)},
0):e==a.keyCode.HOME||e==a.keyCode.PAGE_UP?n(c,0,b.shiftKey?h.begin:0):e==a.keyCode.ESCAPE?(c._valueSet(A),n(c,0,o(c,d))):e==a.keyCode.INSERT?(a.insertMode=!a.insertMode,n(c,!a.insertMode&&h.begin==p(d)?h.begin-1:h.begin)):b.ctrlKey&&88==e?setTimeout(function(){n(c,o(c,d,!0))},0):a.insertMode||(e==a.keyCode.RIGHT?(r=h.begin==h.end?h.end+1:h.end,r=r<p(d)?r:h.end,n(c,b.shiftKey?h.begin:r,b.shiftKey?r+1:r)):e==a.keyCode.LEFT&&(r=h.begin-1,r=0<r?r:0,n(c,r,b.shiftKey?h.end:r)));a.onKeyDown.call(this,b,
d,a);I=-1!=f.inArray(e,a.ignorables)}function k(c){if(q)return!1;q=!0;var b=this,e=f(b),c=c||window.event,g=c.which||c.charCode||c.keyCode,h=String.fromCharCode(g);if(a.numericInput&&h==a.radixPoint){var i=b._valueGet().indexOf(a.radixPoint);n(b,x(d,-1!=i?i:p(d)))}if(c.ctrlKey||c.altKey||c.metaKey||I)return!0;if(g){e.trigger("input");var l=n(b),m=p(d),g=!0;R(d,l.begin,l.end);if(z){var i=M(d,l.end),k;if(!1!==(k=C(i==m||w(d,i)==a.radixPoint?M(d,i):i,h,d,!1))){!0!==k&&(i=void 0!=k.pos?k.pos:i,h=void 0!=
k.c?k.c:h);m=p(d);k=F;if(!0==a.insertMode){if(!0==a.greedy)for(var o=d.slice();w(o,k,!0)!=B(k)&&k<=i;)k=k==m?m+1:x(d,k);k<=i&&(a.greedy||d.length<m)?(d[F]!=B(F)&&d.length<m&&(o=Q(d,-1,z),0!=l.end&&(i+=o),m=d.length),j(k,i,h)):g=!1}else G(d,i,h);g&&(y(b,d,a.numericInput?i+1:i),setTimeout(function(){O(b)&&e.trigger("complete")},0))}else K&&y(b,d,l.begin)}else if(i=x(d,l.begin-1),Q(d,i,z),!1!==(k=C(i,h,d,!1))){!0!==k&&(i=void 0!=k.pos?k.pos:i,h=void 0!=k.c?k.c:h);if(!0==a.insertMode){l=p(d);for(o=d.slice();w(o,
l,!0)!=B(l)&&l>=i;)l=0==l?-1:M(d,l);l>=i?t(i,d.length,h):g=!1}else G(d,i,h);g&&(h=x(d,i),y(b,d,h),setTimeout(function(){O(b)&&e.trigger("complete")},0))}else K&&y(b,d,l.begin);c.preventDefault()}}function m(c){var b=f(this),e=c.keyCode;a.onKeyUp.call(this,c,d,a);e==a.keyCode.TAB&&(b.hasClass("focus.inputmask")&&0==this._valueGet().length&&a.showMaskOnFocus)&&(d=g.slice(),y(this,d),z||n(this,0),A=this._valueGet())}var l=f(e);if(l.is(":input")){var d=g.slice();a.greedy=a.greedy?a.greedy:0==a.repeat;
var u=l.prop("maxLength");p(d)>u&&-1<u&&(u<g.length&&(g.length=u),!1==a.greedy&&(a.repeat=Math.round(u/g.length)),l.prop("maxLength",2*p(d)));l.data("inputmask",{tests:h,_buffer:g,greedy:a.greedy,repeat:a.repeat,autoUnmask:a.autoUnmask,definitions:a.definitions,isRTL:!1});c(e);var A=e._valueGet(),q=!1,I=!1,H=-1,F=x(d,-1);M(d,p(d));var z=!1;if("rtl"==e.dir||a.numericInput)e.dir="ltr",l.css("text-align","right"),l.removeAttr("dir"),u=l.data("inputmask"),u.isRTL=!0,l.data("inputmask",u),z=!0;l.unbind(".inputmask");
l.removeClass("focus.inputmask");l.bind("mouseenter.inputmask",function(){if(!f(this).hasClass("focus.inputmask")&&a.showMaskOnHover){var c=this._valueGet().length;c<d.length&&(0==c&&(d=g.slice()),y(this,d))}}).bind("blur.inputmask",function(){var c=f(this),b=this._valueGet();c.removeClass("focus.inputmask");b!=A&&c.change();a.clearMaskOnLostFocus&&""!=b&&(b==g.join("")?this._valueSet(""):S(this,d));O(this)||(c.trigger("incomplete"),a.clearIncomplete&&(a.clearMaskOnLostFocus?this._valueSet(""):(d=
g.slice(),y(this,d))))}).bind("focus.inputmask",function(){var c=f(this),b=this._valueGet();if(a.showMaskOnFocus&&!c.hasClass("focus.inputmask")&&(!a.showMaskOnHover||a.showMaskOnHover&&""==b))b=b.length,b<d.length&&(0==b&&(d=g.slice()),n(this,o(this,d,!0)));c.addClass("focus.inputmask");A=this._valueGet()}).bind("mouseleave.inputmask",function(){var c=f(this);a.clearMaskOnLostFocus&&(c.hasClass("focus.inputmask")||(this._valueGet()==g.join("")||""==this._valueGet()?this._valueSet(""):S(this,d)))}).bind("click.inputmask",
function(){var a=this;setTimeout(function(){var c=n(a);if(c.begin==c.end){var b=c.begin;H=o(a,d,!1);s(a,c);z?n(a,b>H&&(!1!==C(b,d[b],d,!0)||!v(b))?b:H):n(a,b<H&&(!1!==C(b,d[b],d,!0)||!v(b))?b:H)}},0)}).bind("dblclick.inputmask",function(){var a=this;setTimeout(function(){n(a,0,H)},0)}).bind("keydown.inputmask",D).bind("keypress.inputmask",k).bind("keyup.inputmask",m).bind(X+".inputmask dragdrop.inputmask drop.inputmask",function(){var a=this;setTimeout(function(){n(a,o(a,d,!0))},0)}).bind("setvalue.inputmask",
function(){A=this._valueGet();o(this,d,!0);this._valueGet()==g.join("")&&this._valueSet("")}).bind("complete.inputmask",a.oncomplete).bind("incomplete.inputmask",a.onincomplete).bind("cleared.inputmask",a.oncleared);var H=o(e,d,!0),J;try{J=document.activeElement}catch(P){}J===e?(l.addClass("focus.inputmask"),n(e,H)):a.clearMaskOnLostFocus&&(e._valueGet()==g.join("")?e._valueSet(""):S(e,d));b(e)}}var a=f.extend(!0,{},f.inputmask.defaults,A),X=function(a){var b=document.createElement("input"),a="on"+
a,c=a in b;c||(b.setAttribute(a,"return;"),c="function"==typeof b[a]);return c}("paste")?"paste":"input",W=null!=navigator.userAgent.match(/iphone/i),K=null!=navigator.userAgent.match(/android.*safari.*/i),V;if(K){var I=navigator.userAgent.match(/safari.*/i),I=parseInt(RegExp(/[0-9]+/).exec(I)),K=533>=I;V=534>=(533<I)}if("string"==typeof t)switch(t){case "mask":s(a.alias,A);var g=D(),h=J();return this.each(function(){P(this)});case "unmaskedvalue":return h=this.data("inputmask").tests,g=this.data("inputmask")._buffer,
a.greedy=this.data("inputmask").greedy,a.repeat=this.data("inputmask").repeat,a.definitions=this.data("inputmask").definitions,U(this);case "remove":return this.each(function(){var e=f(this),b=this;setTimeout(function(){if(e.data("inputmask")){h=e.data("inputmask").tests;g=e.data("inputmask")._buffer;a.greedy=e.data("inputmask").greedy;a.repeat=e.data("inputmask").repeat;a.definitions=e.data("inputmask").definitions;b._valueSet(U(e,!0));e.removeData("inputmask");e.unbind(".inputmask");e.removeClass("focus.inputmask");
var c;Object.getOwnPropertyDescriptor&&(c=Object.getOwnPropertyDescriptor(b,"value"));c&&c.get?b._valueGet&&Object.defineProperty(b,"value",{get:b._valueGet,set:b._valueSet}):document.__lookupGetter__&&b.__lookupGetter__("value")&&b._valueGet&&(b.__defineGetter__("value",b._valueGet),b.__defineSetter__("value",b._valueSet));delete b._valueGet;delete b._valueSet}},0)});case "getemptymask":return this.data("inputmask")?this.data("inputmask")._buffer.join(""):"";case "hasMaskedValue":return this.data("inputmask")?
!this.data("inputmask").autoUnmask:!1;case "isComplete":return h=this.data("inputmask").tests,g=this.data("inputmask")._buffer,a.greedy=this.data("inputmask").greedy,a.repeat=this.data("inputmask").repeat,a.definitions=this.data("inputmask").definitions,O(this[0]);default:return s(t,A)||(a.mask=t),g=D(),h=J(),this.each(function(){P(this)})}else{if("object"==typeof t)return a=f.extend(!0,{},f.inputmask.defaults,t),s(a.alias,t),g=D(),h=J(),this.each(function(){P(this)});if(void 0==t)return this.each(function(){var e=
f(this).attr("data-inputmask");if(e&&""!=e)try{var e=e.replace(RegExp("'","g"),'"'),b=f.parseJSON("{"+e+"}");a=f.extend(!0,{},f.inputmask.defaults,b);s(a.alias,b);a.alias=void 0;f(this).inputmask(a)}catch(c){}})}return this})})(jQuery);
