/*
 Input Mask plugin for jquery
 http://github.com/RobinHerbots/jquery.inputmask
 Copyright (c) 2010 - 2013 Robin Herbots
 Licensed under the MIT license (http://www.opensource.org/licenses/mit-license.php)
 Version: 1.3.6
*/
(function(d){void 0==d.fn.inputmask&&(d.inputmask={defaults:{placeholder:"_",optionalmarker:{start:"[",end:"]"},escapeChar:"\\",mask:null,oncomplete:d.noop,onincomplete:d.noop,oncleared:d.noop,repeat:0,greedy:!0,autoUnmask:!1,clearMaskOnLostFocus:!0,insertMode:!0,clearIncomplete:!1,aliases:{},onKeyUp:d.noop,onKeyDown:d.noop,showMaskOnFocus:!0,showMaskOnHover:!0,onKeyValidation:d.noop,numericInput:!1,radixPoint:"",definitions:{9:{validator:"[0-9]",cardinality:1},a:{validator:"[A-Za-z\u0410-\u044f\u0401\u0451]",
cardinality:1},"*":{validator:"[A-Za-z\u0410-\u044f\u0401\u04510-9]",cardinality:1}},keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91},ignorables:[9,13,19,27,33,34,35,36,37,
38,39,40,45,46,93,112,113,114,115,116,117,118,119,120,121,122,123]},val:d.fn.val,escapeRegex:function(d){return d.replace(RegExp("(\\/|\\.|\\*|\\+|\\?|\\||\\(|\\)|\\[|\\]|\\{|\\}|\\\\)","gim"),"\\$1")},getMaskLength:function(d,C,z){var D=d.length;!C&&1<z&&(D+=d.length*(z-1));return D}},d.fn.inputmask=function(s,C){function z(e,b){var c=a.aliases[e];return c?(c.alias&&z(c.alias),d.extend(!0,a,c),d.extend(!0,a,b),!0):!1}function D(){var e=!1,b=0,c=a.mask.toString();1==c.length&&!1==a.greedy&&(a.placeholder=
"");for(var c=d.map(c.split(""),function(c){var d=[];if(c==a.escapeChar)e=true;else if(c!=a.optionalmarker.start&&c!=a.optionalmarker.end||e){var E=a.definitions[c];if(E&&!e)for(c=0;c<E.cardinality;c++)d.push(A(b+c));else{d.push(c);e=false}b=b+d.length;return d}}),E=c.slice(),g=1;g<a.repeat&&a.greedy;g++)E=E.concat(c.slice());return E}function I(){var e=!1,b=!1,c=!1;return d.map(a.mask.toString().split(""),function(d){var g=[];if(d==a.escapeChar)b=!0;else if(d==a.optionalmarker.start&&!b)c=e=!0;else if(d==
a.optionalmarker.end&&!b)e=!1,c=!0;else{var i=a.definitions[d];if(i&&!b){for(var j=i.prevalidator,k=j?j.length:0,h=1;h<i.cardinality;h++){var l=k>=h?j[h-1]:[],f=l.validator,l=l.cardinality;g.push({fn:f?"string"==typeof f?RegExp(f):new function(){this.test=f}:/./,cardinality:l?l:1,optionality:e,newBlockMarker:!0==e?c:!1,offset:0,casing:i.casing,def:d});!0==e&&(c=!1)}g.push({fn:i.validator?"string"==typeof i.validator?RegExp(i.validator):new function(){this.test=i.validator}:/./,cardinality:i.cardinality,
optionality:e,newBlockMarker:c,offset:0,casing:i.casing,def:d})}else g.push({fn:null,cardinality:0,optionality:e,newBlockMarker:c,offset:0,casing:null,def:d}),b=!1;c=!1;return g}})}function G(e,b,c,d){var g=!1;if(0<=e&&e<n()){for(var j=e%i.length,r=b?1:0,k="",h=i[j].cardinality;h>r;h--)k+=t(c,j-(h-1));b&&(k+=b);g=null!=i[j].fn?i[j].fn.test(k,c,e,d,a):!1}setTimeout(function(){a.onKeyValidation.call(this,g,a)},0);return g}function r(e){e=i[e%i.length];return void 0!=e?e.fn:!1}function A(e){return a.placeholder.charAt(e%
a.placeholder.length)}function n(){return d.inputmask.getMaskLength(g,a.greedy,a.repeat)}function w(e,a){var c=n();if(a>=c)return c;for(var d=a;++d<c&&!r(d););return d}function L(a,b){var c=b;if(0>=c)return 0;for(;0<--c&&!r(c););return c}function F(a,b,c){var d=i[b%i.length],g=c;if(void 0!=g)switch(d.casing){case "upper":g=c.toUpperCase();break;case "lower":g=c.toLowerCase()}a[b]=g}function t(a,b,c){c&&(b=P(a,b));return a[b]}function P(a,b,c){if(c)for(;0>b&&a.length<n();){c=g.length-1;for(b=g.length;void 0!==
g[c];)a.unshift(g[c--])}else for(;void 0==a[b]&&a.length<n();)for(c=0;void 0!==g[c];)a.push(g[c++]);return b}function x(a,b,c){a._valueSet(b.join(""));void 0!=c&&(J?setTimeout(function(){j(a,c)},100):j(a,c))}function Q(a,b,c){for(var d=n();b<c&&b<d;b++)F(a,b,t(g.slice(),b))}function K(a,b){F(a,b,t(g,b%i.length))}function m(e,b,c,E){var j=d(e).data("inputmask").isRTL,m=M(e._valueGet(),j).split("");if(j){var B=n(),k=m.reverse();k.length=B;for(var h=0;h<B;h++){var l=(B-(h+1))%i.length;null==i[l].fn&&
k[h]!=t(g,l)?(k.splice(h,0,t(g,l)),k.length=B):k[h]=k[h]||t(g,l)}m=k.reverse()}Q(b,0,b.length);b.length=g.length;for(var f=k=-1,y,B=n(),s=m.length,l=0==s?B:-1,h=0;h<s;h++)for(var q=f+1;q<B;q++)if(r(q)){var u=m[h];!1!==(y=G(q,u,b,!c))?(!0!==y&&(q=void 0!=y.pos?y.pos:q,u=void 0!=y.c?y.c:u),F(b,q,u),k=f=q):(K(b,q),u==A(q)&&(l=f=q));break}else if(K(b,q),k==f&&(k=q),f=q,m[h]==t(b,q))break;if(!1==a.greedy)for(h=M(b.join(""),j).split("");b.length!=h.length;)j?b.shift():b.pop();c&&x(e,b);return j?a.numericInput?
""!=a.radixPoint&&-1!=d.inArray(a.radixPoint,b)&&!0!==E?d.inArray(a.radixPoint,b):w(b,B):w(b,l):w(b,k)}function S(a){return d.inputmask.escapeRegex.call(this,a)}function M(a,b){return b?a.replace(RegExp("^("+S(g.join(""))+")*"),""):a.replace(RegExp("("+S(g.join(""))+")*$"),"")}function R(a,b){m(a,b,!1);var c=b.slice();if(d(a).data("inputmask").isRTL)for(var g=0;g<=c.length-1;g++){var j=g%i.length;if(i[j].optionality)if(A(g)==b[g]||!r(g))c.splice(0,1);else break;else break}else for(g=c.length-1;0<=
g;g--)if(j=g%i.length,i[j].optionality)if(A(g)==b[g]||!r(g))c.pop();else break;else break;x(a,c)}function T(a,b){var c=a[0];if(i&&(!0===b||!a.hasClass("hasDatepicker"))){var j=g.slice();m(c,j);return d.map(j,function(a,b){return r(b)&&a!=t(g.slice(),b)?a:null}).join("")}return c._valueGet()}function j(e,b,c){if(d(e).is(":visible"))if(e=e.jquery&&0<e.length?e[0]:e,"number"==typeof b){c="number"==typeof c?c:b;!1==a.insertMode&&b==c&&c++;if(e.setSelectionRange)e.setSelectionRange(b,c);else if(e.createTextRange){var g=
e.createTextRange();g.collapse(!0);g.moveEnd("character",c);g.moveStart("character",b);g.select()}e.focus()}else{var j=J?g:null,g=null;null==j&&(e.setSelectionRange?(b=e.selectionStart,c=e.selectionEnd):document.selection&&document.selection.createRange&&(g=document.selection.createRange(),b=0-g.duplicate().moveStart("character",-1E5),c=b+g.text.length),j={begin:b,end:c});return j}}function N(a){for(var b=!0,a=a._valueGet(),c=a.length,d=0;d<c;d++)if(r(d)&&a.charAt(d)==A(d)){b=!1;break}return b}function O(e){function b(a){a=
d._data(a).events;d.each(a,function(a,b){d.each(b,function(a,b){if("inputmask"==b.namespace){var f=b.handler;b.handler=function(){return this.readOnly||this.disabled?!1:f.apply(this,arguments)}}})})}function c(a){var b;Object.getOwnPropertyDescriptor&&(b=Object.getOwnPropertyDescriptor(a,"value"));if(b&&b.get)a._valueGet||(a._valueGet=b.get,a._valueSet=b.set,Object.defineProperty(a,"value",{get:function(){var a=d(this),b=d(this).data("inputmask");return b&&b.autoUnmask?a.inputmask("unmaskedvalue"):
this._valueGet()!=b._buffer.join("")?this._valueGet():""},set:function(a){this._valueSet(a);d(this).triggerHandler("setvalue.inputmask")}}));else if(document.__lookupGetter__&&a.__lookupGetter__("value"))a._valueGet||(a._valueGet=a.__lookupGetter__("value"),a._valueSet=a.__lookupSetter__("value"),a.__defineGetter__("value",function(){var a=d(this),b=d(this).data("inputmask");return b&&b.autoUnmask?a.inputmask("unmaskedvalue"):this._valueGet()!=b._buffer.join("")?this._valueGet():""}),a.__defineSetter__("value",
function(a){this._valueSet(a);d(this).triggerHandler("setvalue.inputmask")}));else if(a._valueGet||(a._valueGet=function(){return this.value},a._valueSet=function(a){this.value=a}),!0!=d.fn.val.inputmaskpatch)d.fn.val=function(){if(arguments.length==0){var a=d(this);if(a.data("inputmask")){if(a.data("inputmask").autoUnmask)return a.inputmask("unmaskedvalue");var b=d.inputmask.val.apply(a);return b!=a.data("inputmask")._buffer.join("")?b:""}return d.inputmask.val.apply(a)}var f=arguments;return this.each(function(){var a=
d(this),b=d.inputmask.val.apply(a,f);a.data("inputmask")&&a.triggerHandler("setvalue.inputmask");return b})},d.extend(d.fn.val,{inputmaskpatch:!0})}function s(a,b,c){for(;!r(a)&&0<=a-1;)a--;for(var d=a;d<b&&d<n();d++)if(r(d)){K(f,d);var e=w(f,d),o=t(f,e);if(o!=A(e))if(e<n()&&!1!==G(d,o,f,!0)&&i[d%i.length].def==i[e%i.length].def)F(f,d,t(f,e)),K(f,e);else{if(r(d))break}else if(void 0==c)break}else K(f,d);void 0!=c&&F(f,v?b:L(f,b),c);f=M(f.join(""),v).split("");0==f.length&&(f=g.slice());return a}function z(a,
b,d,c){for(;a<=b&&a<n();a++)if(r(a)){var e=t(f,a);F(f,a,d);if(e!=A(a))if(d=w(f,a),d<n())if(!1!==G(d,e,f,!0)&&i[a%i.length].def==i[d%i.length].def)d=e;else if(r(d))break;else d=e;else break;else if(!0!==c)break}else K(f,a);c=f.length;f=M(f.join(""),v).split("");0==f.length&&(f=g.slice());return b-(c-f.length)}function D(b){C=!1;var c=this,e=b.keyCode,i=j(c);if(a.numericInput&&""!=a.radixPoint){var h=c._valueGet().indexOf(a.radixPoint);-1!=h&&(v=i.begin<=h||i.end<=h)}if(e==a.keyCode.BACKSPACE||e==a.keyCode.DELETE||
U&&127==e){h=n();if(0==i.begin&&i.end==h)f=g.slice(),x(c,f),j(c,m(c,f,!1));else if(1<i.end-i.begin||1==i.end-i.begin&&a.insertMode)Q(f,i.begin,i.end),x(c,f),j(v?m(c,f,!1):i.begin);else{var o=i.begin-(e==a.keyCode.DELETE?0:1);o<H&&e==a.keyCode.DELETE&&(o=H);o>=H&&(a.numericInput&&a.greedy&&e==a.keyCode.DELETE&&f[o]==a.radixPoint?(o=w(f,o),v=!1):a.numericInput&&(a.greedy&&e==a.keyCode.BACKSPACE&&f[o]==a.radixPoint)&&(o--,v=!0),v?(o=z(H,o,A(o),!0),o=a.numericInput&&a.greedy&&e==a.keyCode.BACKSPACE&&
f[o+1]==a.radixPoint?o+1:w(f,o)):o=s(o,h),x(c,f,o))}c._valueGet()==g.join("")&&d(c).trigger("cleared");b.preventDefault()}else e==a.keyCode.END||e==a.keyCode.PAGE_DOWN?setTimeout(function(){var d=m(c,f,!1,!0);!a.insertMode&&(d==n()&&!b.shiftKey)&&d--;j(c,b.shiftKey?i.begin:d,d)},0):e==a.keyCode.HOME||e==a.keyCode.PAGE_UP?j(c,0,b.shiftKey?i.begin:0):e==a.keyCode.ESCAPE?(c._valueSet(y),j(c,0,m(c,f))):e==a.keyCode.INSERT?(a.insertMode=!a.insertMode,j(c,!a.insertMode&&i.begin==n()?i.begin-1:i.begin)):
b.ctrlKey&&88==e?setTimeout(function(){j(c,m(c,f,!0))},0):a.insertMode||(e==a.keyCode.RIGHT?(h=i.begin==i.end?i.end+1:i.end,h=h<n()?h:i.end,j(c,b.shiftKey?i.begin:h,b.shiftKey?h+1:h)):e==a.keyCode.LEFT&&(h=i.begin-1,h=0<h?h:0,j(c,h,b.shiftKey?i.end:h)));a.onKeyDown.call(this,b,a);q=-1!=d.inArray(e,a.ignorables)}function B(b){if(C)return!1;C=!0;var c=this,e=d(c),b=b||window.event,g=b.which||b.charCode||b.keyCode,i=String.fromCharCode(g);if(a.numericInput&&i==a.radixPoint){var h=c._valueGet().indexOf(a.radixPoint);
j(c,w(f,-1!=h?h:n()))}if(b.ctrlKey||b.altKey||b.metaKey||q)return!0;if(g){e.trigger("input");var k=j(c),l=n(),g=!0;Q(f,k.begin,k.end);if(v){var h=L(f,k.end),p;if(!1!==(p=G(h==l||t(f,h)==a.radixPoint?L(f,h):h,i,f,!1))){!0!==p&&(h=void 0!=p.pos?p.pos:h,i=void 0!=p.c?p.c:i);p=H;if(!0==a.insertMode){if(!0==a.greedy)for(var m=f.slice();t(m,p,!0)!=A(p)&&p<=h;)p=p==l?l+1:w(f,p);p<=h&&(a.greedy||f.length<l)?(f[H]!=A(H)&&f.length<l&&(l=P(f,-1,v),0!=k.end&&(h+=l),l=f.length),s(p,h,i)):g=!1}else F(f,h,i);g&&
(x(c,f,a.numericInput?h+1:h),setTimeout(function(){N(c)&&e.trigger("complete")},0))}else J&&x(c,f,k.begin)}else if(h=w(f,k.begin-1),P(f,h,v),!1!==(p=G(h,i,f,!1))){!0!==p&&(h=void 0!=p.pos?p.pos:h,i=void 0!=p.c?p.c:i);if(!0==a.insertMode){k=n();for(m=f.slice();t(m,k,!0)!=A(k)&&k>=h;)k=0==k?-1:L(f,k);k>=h?z(h,f.length,i):g=!1}else F(f,h,i);g&&(i=w(f,h),x(c,f,i),setTimeout(function(){N(c)&&e.trigger("complete")},0))}else J&&x(c,f,k.begin);b.preventDefault()}}function k(b){var c=d(this),e=b.keyCode;a.onKeyUp.call(this,
b,a);e==a.keyCode.TAB&&(c.hasClass("focus.inputmask")&&0==this._valueGet().length)&&(f=g.slice(),x(this,f),v||j(this,0),y=this._valueGet())}var h=d(e);if(h.is(":input")){a.greedy=a.greedy?a.greedy:0==a.repeat;var l=h.prop("maxLength");n()>l&&-1<l&&(l<g.length&&(g.length=l),!1==a.greedy&&(a.repeat=Math.round(l/g.length)),h.prop("maxLength",2*n()));h.data("inputmask",{tests:i,_buffer:g,greedy:a.greedy,repeat:a.repeat,autoUnmask:a.autoUnmask,definitions:a.definitions,isRTL:!1});c(e);var f=g.slice(),
y=e._valueGet(),C=!1,q=!1,u=-1,H=w(f,-1);L(f,n());var v=!1;if("rtl"==e.dir||a.numericInput)e.dir="ltr",h.css("text-align","right"),h.removeAttr("dir"),l=h.data("inputmask"),l.isRTL=!0,h.data("inputmask",l),v=!0;h.unbind(".inputmask");h.removeClass("focus.inputmask");h.bind("mouseenter.inputmask",function(){if(!d(this).hasClass("focus.inputmask")&&a.showMaskOnHover){var b=this._valueGet().length;b<f.length&&(0==b&&(f=g.slice()),x(this,f))}}).bind("blur.inputmask",function(){var b=d(this),c=this._valueGet();
b.removeClass("focus.inputmask");c!=y&&b.change();a.clearMaskOnLostFocus&&""!=c&&(c==g.join("")?this._valueSet(""):R(this,f));N(this)||(b.trigger("incomplete"),a.clearIncomplete&&(a.clearMaskOnLostFocus?this._valueSet(""):(f=g.slice(),x(this,f))))}).bind("focus.inputmask",function(){var b=d(this),c=this._valueGet();if(a.showMaskOnFocus&&!b.hasClass("focus.inputmask")&&(!a.showMaskOnHover||a.showMaskOnHover&&""==c))c=c.length,c<f.length&&(0==c&&(f=g.slice()),j(this,m(this,f,!0)));b.addClass("focus.inputmask");
y=this._valueGet()}).bind("mouseleave.inputmask",function(){var b=d(this);a.clearMaskOnLostFocus&&(b.hasClass("focus.inputmask")||(this._valueGet()==g.join("")||""==this._valueGet()?this._valueSet(""):R(this,f)))}).bind("click.inputmask",function(){var a=this;setTimeout(function(){var b=j(a);b.begin==b.end&&(b=b.begin,u=m(a,f,!1),v?j(a,b>u&&(!1!==G(b,f[b],f,!0)||!r(b))?b:u):j(a,b<u&&(!1!==G(b,f[b],f,!0)||!r(b))?b:u))},0)}).bind("dblclick.inputmask",function(){var a=this;setTimeout(function(){j(a,
0,u)},0)}).bind("keydown.inputmask",D).bind("keypress.inputmask",B).bind("keyup.inputmask",k).bind(V+".inputmask dragdrop.inputmask drop.inputmask",function(){var a=this;setTimeout(function(){j(a,m(a,f,!0))},0)}).bind("setvalue.inputmask",function(){y=this._valueGet();m(this,f,!0);this._valueGet()==g.join("")&&this._valueSet("")}).bind("complete.inputmask",a.oncomplete).bind("incomplete.inputmask",a.onincomplete).bind("cleared.inputmask",a.oncleared);var u=m(e,f,!0),I;try{I=document.activeElement}catch(O){}I===
e?(h.addClass("focus.inputmask"),j(e,u)):a.clearMaskOnLostFocus&&(e._valueGet()==g.join("")?e._valueSet(""):R(e,f));b(e)}}var a=d.extend(!0,{},d.inputmask.defaults,C),V=function(a){var b=document.createElement("input"),a="on"+a,c=a in b;c||(b.setAttribute(a,"return;"),c="function"==typeof b[a]);return c}("paste")?"paste":"input",U=null!=navigator.userAgent.match(/iphone/i),J=null!=navigator.userAgent.match(/android.*mobile safari.*/i);if(J)var W=navigator.userAgent.match(/mobile safari.*/i),J=533>=
parseInt(RegExp(/[0-9]+/).exec(W));if("string"==typeof s)switch(s){case "mask":z(a.alias,C);var g=D(),i=I();return this.each(function(){O(this)});case "unmaskedvalue":return i=this.data("inputmask").tests,g=this.data("inputmask")._buffer,a.greedy=this.data("inputmask").greedy,a.repeat=this.data("inputmask").repeat,a.definitions=this.data("inputmask").definitions,T(this);case "remove":return this.each(function(){var e=d(this),b=this;setTimeout(function(){if(e.data("inputmask")){i=e.data("inputmask").tests;
g=e.data("inputmask")._buffer;a.greedy=e.data("inputmask").greedy;a.repeat=e.data("inputmask").repeat;a.definitions=e.data("inputmask").definitions;b._valueSet(T(e,!0));e.removeData("inputmask");e.unbind(".inputmask");e.removeClass("focus.inputmask");var c;Object.getOwnPropertyDescriptor&&(c=Object.getOwnPropertyDescriptor(b,"value"));c&&c.get?b._valueGet&&Object.defineProperty(b,"value",{get:b._valueGet,set:b._valueSet}):document.__lookupGetter__&&b.__lookupGetter__("value")&&b._valueGet&&(b.__defineGetter__("value",
b._valueGet),b.__defineSetter__("value",b._valueSet));delete b._valueGet;delete b._valueSet}},0)});case "getemptymask":return this.data("inputmask")?this.data("inputmask")._buffer.join(""):"";case "hasMaskedValue":return this.data("inputmask")?!this.data("inputmask").autoUnmask:!1;case "isComplete":return i=this.data("inputmask").tests,g=this.data("inputmask")._buffer,a.greedy=this.data("inputmask").greedy,a.repeat=this.data("inputmask").repeat,a.definitions=this.data("inputmask").definitions,N(this[0]);
default:return z(s,C)||(a.mask=s),g=D(),i=I(),this.each(function(){O(this)})}else{if("object"==typeof s)return a=d.extend(!0,{},d.inputmask.defaults,s),z(a.alias,s),g=D(),i=I(),this.each(function(){O(this)});if(void 0==s)return this.each(function(){var e=d(this).attr("data-inputmask");if(e&&""!=e)try{var e=e.replace(RegExp("'","g"),'"'),b=d.parseJSON("{"+e+"}");a=d.extend(!0,{},d.inputmask.defaults,b);z(a.alias,b);a.alias=void 0;d(this).inputmask(a)}catch(c){}})}return this})})(jQuery);
